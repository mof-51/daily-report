# 取り組んだ課題一覧
- Ruby on Rails5 VI〜Ⅷ(学習レッスン)
- Ruby on Rails5 Ⅲ(道場レッスン)途中まで

# わかったこと
## 画像
- 画像データは`app名/public/user_images`の中に格納する
- 画像ファイル名はデータベースに保存するため、「画像データ自体」「画像ファイル名」ぞれぞれを保存するための処理が必要
- データベース名の画像のファイル名と保存した画像のファイル名で合致するものがあれば表示される
- 画像をデータベースに登録する際はform_tagの第二引数に`{multipart: true}`を入れる
- コンピュータは人間が目で見た見た目での保存ができないためテキストに変換して保存する
- 画像の取り扱いはRubyで元から用意されている`Fileクラス`を用いる
- 他の要素と同じように`params`の中にデータが保存されている

## マイグレーションファイル
- モデルと同時に作成した場合(`rails g model`)はマイグレーションファイル内のchangeメソッドの中身が自動生成されるため、そのままデータベースに反映できる
- マイグレーションファイル単体で作成した場合(`rails g migrate`)はchangeメソッドの中身が空のため、データベースに反映する内容を記載してからデータベースに反映する必要がある
- 既存テーブルへのカラム追加のマイグレーションファイル作成は`rails g migration add_カラム名_to_テーブル名`
- 作成したマイグレーションファイルのchangeメソッドの中身は、カラム追加の場合は`add_column :テーブル名, :カラム名, :データ型`

## ログイン・ログアウト機能
- 入力されたログイン情報をRailsに送信しデータベースと照合する、一致するものがあればログイン成功となる
- 入力された情報を`find_by`で照合することで一致するデータを見つけ出せる
- バリデーションエラーのように元々準備されたエラー文が存在しない場合はアクションで表示したいエラーメッセージを定義する必要がある
- ログイン・ログアウトの管理は`session`で行う
- sessionにログインしたユーザのuser_idをキーとして代入することで、そのユーザ固有の情報の表示や挙動の制御ができる。`session[:user_id] = @user.id`
- sessionの情報はブラウザに保存され、ログイン操作以降、ページ移動の際など都度sessionの値がRailに送信されるため、ページが推移してもログイン状態が保持される
- ログアウト時はsessionの値を`nil`にする

## application.html.erb内での変数定義
- `application.html.erb`はビューファイルのベースで全アクションから呼び出されるため、application.html.erb内で変数を使おうとすると全アクションに同じ変数を定義しなければいけない。それをしなくて良いように`before_action`を使用する。application.html.erbにbefore_actionでアクションを定義することで、各コントローラ内のアクションが処理される前に必ずbefore_actionで定義したアクションが呼び出され、全アクションで定義した変数を使用することができる
- 上記で設定したbefore_actionは各コントローラで使用でき、コントローラ内の一部のアクションにのみ適用したい場合は`only`でアクション名を指定する。`before_action :アクション名, {only: [:適用したいアクション名, :適用したいアクション名]}`

# 次やること
- Ruby on Rails5 Ⅲ(道場レッスン)途中から

# 感じたこと
ログイン・ログアウトの処理はむずかしいという先入観があったけど、それ自体は実はそうでもなかった。ただ、ログインしている状態としていない状態での表示分けや、ログインしているユーザ本人しかアクセスできないユーザ情報の編集など、セキュリティを確保するための処理が少しいややこしい。  
Progateで一工程ずつ進めているから余計に難しく感じるのかなとも思う。アプリを作る前に全体の仕様を把握して理解しきれていればそこまで難しくはないのかも。  
なんとなくRailsをつかめてきているような気はするけど、感覚的な感じでまだ文章に起こせる感じではない。慣れる！

# 学習時間
Today：6h Total：36.5h
